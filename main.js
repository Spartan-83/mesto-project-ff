/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function t(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(t,o,c,a){var i=o&&o.prototype instanceof l?o:l,s=Object.create(i.prototype);return e(s,"_invoke",function(t,e,o){var c,a,i,l=0,s=o||[],f=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return c=t,a=0,i=n,p.n=e,u}};function d(t,e){for(a=t,i=e,r=0;!f&&l&&!o&&r<s.length;r++){var o,c=s[r],d=p.p,v=c[2];t>3?(o=v===e)&&(a=c[4]||3,i=c[5]===n?c[3]:c[5],c[4]=3,c[5]=n):c[0]<=d&&((o=t<2&&d<c[1])?(a=0,p.v=e,p.n=c[1]):d<v&&(o=t<3||c[0]>e||e>v)&&(c[4]=t,c[5]=e,p.n=v,a=0))}if(o||t>1)return u;throw f=!0,e}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,v),a=s,i=v;(r=a<2?n:i)||!f;){c||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(l=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=n}else if((r=(f=p.n<0)?i:t.call(e,p))!==u)break}catch(t){c=n,a=1,i=t}finally{l=1}}return{value:r,done:f}}}(t,c,a),!0),s}var u={};function l(){}function s(){}function f(){}r=Object.getPrototypeOf;var p=[][c]?r(r([][c]())):(e(r={},c,(function(){return this})),r),d=f.prototype=l.prototype=Object.create(p);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=f,e(d,"constructor",f),e(f,"constructor",s),s.displayName="GeneratorFunction",e(f,a,"GeneratorFunction"),e(d),e(d,a,"Generator"),e(d,c,(function(){return this})),e(d,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:i,m:v}})()}function e(t,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}e=function(t,n,r,o){if(n)c?c(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r;else{function a(n,r){e(t,n,(function(t){return this._invoke(n,r,t)}))}a("next",0),a("throw",1),a("return",2)}},e(t,n,r,o)}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}var o={baseUrl:"https://nomoreparties.co/v1//wff-cohort-41",headers:{authorization:"fe7ae636-3daa-429f-a858-14d86ef6e8ee","Content-Type":"application/json"}};function c(t,e,n,r){e.style.backgroundImage="url(".concat(t.avatar,")"),n.textContent=t.name,r.textContent=t.about}function a(t,e,n,r,o,c){for(var a=0;a<t.length;a++)e.append(n(t[a].name,t[a].link,r,o,t[a].likes,t[a]._id,c._id,t[a].owner._id))}function i(t){return u.apply(this,arguments)}function u(){var e;return e=t().m((function e(r){var i,u,l,s,f,p,d,v,y,m,h;return t().w((function(t){for(;;)switch(t.n){case 0:return i=r.profileAvatar,u=r.profileTitle,l=r.profileDesc,s=r.container,f=r.createFunc,p=r.deleteFunc,d=r.openFunc,t.n=1,Promise.all([fetch("".concat(o.baseUrl,"/users/me"),{headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)})),fetch("".concat(o.baseUrl,"/cards"),{headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))]);case 1:v=t.v,_=2,y=function(t){if(Array.isArray(t))return t}(e=v)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,l=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return i}}(e,_)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(e,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),m=y[0],h=y[1],s.innerHTML="",c(m,i,u,l),a(h,s,f,p,d,m);case 2:return t.a(2)}var e,_}),e)})),u=function(){var t=this,n=arguments;return new Promise((function(o,c){var a=e.apply(t,n);function i(t){r(a,o,c,i,u,"next",t)}function u(t){r(a,o,c,i,u,"throw",t)}i(void 0)}))},u.apply(this,arguments)}function l(t){return fetch("".concat(o.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:t})}).then((function(t){return t.json()})).catch((function(t){console.log(t)}))}var s=document.querySelector("#card-template").content;function f(t,e,n,r,c,a,i,u){var l=s.cloneNode(!0),f=l.querySelector(".card__delete-button"),p=l.querySelector(".card__like-button"),d=l.querySelector(".card__image"),v=l.querySelector(".card__like-ammount");return l.querySelector(".card__title").textContent=t,d.src=e,d.alt="На картинке изображен "+t,v.textContent=c.length,i===u?f.addEventListener("click",(function(t){var e=t.target.closest(".card");n(a,e)})):f.remove(),c.find((function(t){return t._id===i}))&&p.classList.add("card__like-button_is-active"),p.addEventListener("click",(function(){return function(t,e,n){t.classList.contains("card__like-button_is-active")?(function(t){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}(n).then((function(t){return e.textContent=t.likes.length})),t.classList.toggle("card__like-button_is-active")):(function(t){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}(n).then((function(t){return e.textContent=t.likes.length})),t.classList.toggle("card__like-button_is-active"))}(p,v,a)})),d.addEventListener("click",(function(){return r(d.src,d.alt,t)})),l}var p=function(t,e){!function(t){fetch("".concat(o.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:o.headers}).catch((function(t){console.log(t)}))}(t),e.remove()};function d(t){t.classList.add("popup_is-opened"),t.addEventListener("mousedown",m),document.addEventListener("keydown",y)}function v(t){t.classList.remove("popup_is-opened"),t.removeEventListener("mousedown",m),document.removeEventListener("keydown",y)}var y=function(t){var e=document.querySelector(".popup_is-opened");"Escape"===t.key&&v(e)},m=function(t){var e=document.querySelector(".popup_is-opened");(t.target===e||t.target.classList.contains("popup__close"))&&v(e)},h=function(t,e,n,r){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n),o.classList.remove(r),o.textContent=""},_=function(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.classList.remove(n),e.disabled=!1):(e.classList.add(n),e.disabled=!0)},b=function(t,e){var n=e.inputSelector,r=e.inputErrorClass,o=e.errorClass;Array.from(t.querySelectorAll(n)).forEach((function(e){h(t,e,r,o)}))};function S(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,c){var u=r&&r.prototype instanceof i?r:i,l=Object.create(u.prototype);return g(l,"_invoke",function(n,r,o){var c,i,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return c=e,i=0,u=t,p.n=n,a}};function d(n,r){for(i=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,c=s[e],d=p.p,v=c[2];n>3?(o=v===r)&&(i=c[4]||3,u=c[5]===t?c[3]:c[5],c[4]=3,c[5]=t):c[0]<=d&&((o=n<2&&d<c[1])?(i=0,p.v=r,p.n=c[1]):d<v&&(o=n<3||c[0]>r||r>v)&&(c[4]=n,c[5]=r,p.n=v,i=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,v),i=s,u=v;(e=i<2?t:u)||!f;){c||(i?i<3?(i>1&&(p.n=-1),d(i,u)):p.n=u:p.v=u);try{if(l=2,c){if(i||(o="next"),e=c[o]){if(!(e=e.call(c,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,i<2&&(i=0)}else 1===i&&(e=c.return)&&e.call(c),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){c=t,i=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,c),!0),l}var a={};function i(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(g(e={},r,(function(){return this})),e),f=l.prototype=i.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,g(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,g(f,"constructor",l),g(l,"constructor",u),u.displayName="GeneratorFunction",g(l,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,(function(){return this})),g(f,"toString",(function(){return"[object Generator]"})),(S=function(){return{w:c,m:p}})()}function g(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}g=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function c(e,n){g(t,e,(function(t){return this._invoke(e,n,t)}))}c("next",0),c("throw",1),c("return",2)}},g(t,e,n,r)}function w(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function k(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var c=t.apply(e,n);function a(t){w(c,r,o,a,i,"next",t)}function i(t){w(c,r,o,a,i,"throw",t)}a(void 0)}))}}var E,j,q,L,C,O,T,P=document.querySelector(".places__list"),x=document.querySelector(".profile__edit-button"),A=document.querySelector(".profile__add-button"),F=document.querySelector(".popup_type_edit"),G=document.forms["edit-profile"],U=document.querySelector(".profile__title"),D=document.querySelector(".profile__description"),N=document.querySelector(".profile__image"),M=G.querySelector(".button"),B=document.querySelector(".popup_type_image"),I=B.querySelector(".popup__image"),H=B.querySelector(".popup__caption"),J=document.querySelector(".popup_type_new-card"),V=document.forms["new-place"],z=V.querySelector(".button"),$=document.querySelector(".popup_type_avatar"),K=document.querySelector(".profile__image-edit-button"),Q=document.forms["edit-avatar"],R=Q.querySelector(".button"),W=(Q.querySelector(".popup__input_type_avatar_url"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button-disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),X={profileAvatar:N,profileTitle:U,profileDesc:D,container:P,createFunc:f,deleteFunc:p,openFunc:Y};function Y(t,e,n){I.src=t,I.alt=e,H.textContent=n,d(B)}function Z(t){t.textContent="Сохранение..."}function tt(t){t.textContent="Сохранить"}i(X),x.addEventListener("click",(function(){d(F),G.name.value=U.textContent,G.description.value=D.textContent,b(F,W)})),K.addEventListener("click",k(S().m((function t(){return S().w((function(t){for(;;)switch(t.n){case 0:d($),Q.avatar.value="",b($,W);case 1:return t.a(2)}}),t)})))),A.addEventListener("click",(function(){d(J),V["place-name"].value="",V.link.value="",b(V,W)})),Q.addEventListener("submit",function(){var t=k(S().m((function t(e){var n;return S().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),n=Q.avatar.value,Z(R),t.n=1,l(n);case 1:return t.n=2,i(X);case 2:v($),tt(R);case 3:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}()),V.addEventListener("submit",function(){var t=k(S().m((function t(e){var n,r;return S().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),n=V["place-name"].value,r=V.link.value,t.n=1,c=n,a=r,fetch("".concat(o.baseUrl,"/cards"),{method:"POST",headers:o.headers,body:JSON.stringify({name:c,link:a})}).catch((function(t){console.log(t)}));case 1:return Z(z),t.n=2,i(X);case 2:P.prepend(f(n,r,p,Y)),v(J),V["place-name"].value="",V.link.value="",tt(z);case 3:return t.a(2)}var c,a}),t)})));return function(e){return t.apply(this,arguments)}}()),G.addEventListener("submit",function(){var t=k(S().m((function t(e){return S().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),t.n=1,n=G.elements.name.value,r=G.elements.description.value,void fetch("".concat(o.baseUrl,"/users/me"),{method:"PATCH",headers:o.headers,body:JSON.stringify({name:n,about:r})}).catch((function(t){console.log(t)}));case 1:return Z(M),t.n=2,i(X);case 2:v(F),tt(M);case 3:return t.a(2)}var n,r}),t)})));return function(e){return t.apply(this,arguments)}}()),j=(E=W).formSelector,q=E.inputSelector,L=E.submitButtonSelector,C=E.inactiveButtonClass,O=E.inputErrorClass,T=E.errorClass,Array.from(document.querySelectorAll(j)).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),Array.from(t.querySelectorAll(q)).forEach((function(e){!function(t,e,n,r,o,c){var a=Array.from(t.querySelectorAll(e)),i=t.querySelector(n);_(a,i,r),a.forEach((function(e){e.addEventListener("input",(function(){!function(t,e,n,r){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?h(t,e,n,r):function(t,e,n,r,o){var c=t.querySelector(".".concat(e.id,"-error"));e.classList.add(r),c.textContent=n,c.classList.add(o)}(t,e,e.validationMessage,n,r)}(t,e,o,c),_(a,i,r)}))}))}(t,q,L,C,O,T)}))}))})();