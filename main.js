/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function t(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(t,o,c,a){var i=o&&o.prototype instanceof s?o:s,l=Object.create(i.prototype);return e(l,"_invoke",function(t,e,o){var c,a,i,s=0,l=o||[],f=!1,d={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(t,e){return c=t,a=0,i=n,d.n=e,u}};function p(t,e){for(a=t,i=e,r=0;!f&&s&&!o&&r<l.length;r++){var o,c=l[r],p=d.p,v=c[2];t>3?(o=v===e)&&(a=c[4]||3,i=c[5]===n?c[3]:c[5],c[4]=3,c[5]=n):c[0]<=p&&((o=t<2&&p<c[1])?(a=0,d.v=e,d.n=c[1]):p<v&&(o=t<3||c[0]>e||e>v)&&(c[4]=t,c[5]=e,d.n=v,a=0))}if(o||t>1)return u;throw f=!0,e}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,v),a=l,i=v;(r=a<2?n:i)||!f;){c||(a?a<3?(a>1&&(d.n=-1),p(a,i)):d.n=i:d.v=i);try{if(s=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=n}else if((r=(f=d.n<0)?i:t.call(e,d))!==u)break}catch(t){c=n,a=1,i=t}finally{s=1}}return{value:r,done:f}}}(t,c,a),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var d=[][c]?r(r([][c]())):(e(r={},c,(function(){return this})),r),p=f.prototype=s.prototype=Object.create(d);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,a,"GeneratorFunction")),t.prototype=Object.create(p),t}return l.prototype=f,e(p,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,a,"GeneratorFunction"),e(p),e(p,a,"Generator"),e(p,c,(function(){return this})),e(p,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:i,m:v}})()}function e(t,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}e=function(t,n,r,o){if(n)c?c(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r;else{function a(n,r){e(t,n,(function(t){return this._invoke(n,r,t)}))}a("next",0),a("throw",1),a("return",2)}},e(t,n,r,o)}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}var o={baseUrl:"https://nomoreparties.co/v1//wff-cohort-41",headers:{authorization:"fe7ae636-3daa-429f-a858-14d86ef6e8ee","Content-Type":"application/json"}};function c(t,e,n,r){e.style.backgroundImage="url(".concat(t.avatar,")"),n.textContent=t.name,r.textContent=t.about}function a(t,e,n,r,o,c){for(var a=0;a<t.length;a++)e.append(n(t[a].name,t[a].link,r,o,t[a].likes,t[a]._id,c._id,t[a].owner._id))}function i(t){return u.apply(this,arguments)}function u(){var e;return e=t().m((function e(r){var i,u,s,l,f,d,p,v,y,m,h;return t().w((function(t){for(;;)switch(t.n){case 0:return i=r.profileAvatar,u=r.profileTitle,s=r.profileDesc,l=r.container,f=r.createFunc,d=r.deleteFunc,p=r.openFunc,t.n=1,Promise.all([fetch("".concat(o.baseUrl,"/users/me"),{headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)})),fetch("".concat(o.baseUrl,"/cards"),{headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))]);case 1:v=t.v,_=2,y=function(t){if(Array.isArray(t))return t}(e=v)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,s=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return i}}(e,_)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(e,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),m=y[0],h=y[1],l.innerHTML="",c(m,i,u,s),a(h,l,f,d,p,m);case 2:return t.a(2)}var e,_}),e)})),u=function(){var t=this,n=arguments;return new Promise((function(o,c){var a=e.apply(t,n);function i(t){r(a,o,c,i,u,"next",t)}function u(t){r(a,o,c,i,u,"throw",t)}i(void 0)}))},u.apply(this,arguments)}function s(t){return fetch("".concat(o.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:t})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}var l=document.querySelector("#card-template").content;function f(t){t.classList.add("popup_is-opened"),t.addEventListener("mousedown",v),document.addEventListener("keydown",p)}function d(t){t.classList.remove("popup_is-opened"),t.removeEventListener("mousedown",v),document.removeEventListener("keydown",p)}var p=function(t){var e=document.querySelector(".popup_is-opened");"Escape"===t.key&&d(e)},v=function(t){var e=document.querySelector(".popup_is-opened");(t.target===e||t.target.classList.contains("popup__close"))&&d(e)},y=function(t,e,n,r){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n),o.classList.remove(r),o.textContent=""},m=function(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.classList.remove(n),e.disabled=!1):(e.classList.add(n),e.disabled=!0)},h=function(t,e){var n=e.inputSelector,r=e.inputErrorClass,o=e.errorClass;Array.from(t.querySelectorAll(n)).forEach((function(e){y(t,e,r,o)}))};function _(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,c){var u=r&&r.prototype instanceof i?r:i,s=Object.create(u.prototype);return b(s,"_invoke",function(n,r,o){var c,i,u,s=0,l=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return c=e,i=0,u=t,d.n=n,a}};function p(n,r){for(i=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,c=l[e],p=d.p,v=c[2];n>3?(o=v===r)&&(i=c[4]||3,u=c[5]===t?c[3]:c[5],c[4]=3,c[5]=t):c[0]<=p&&((o=n<2&&p<c[1])?(i=0,d.v=r,d.n=c[1]):p<v&&(o=n<3||c[0]>r||r>v)&&(c[4]=n,c[5]=r,d.n=v,i=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,v),i=l,u=v;(e=i<2?t:u)||!f;){c||(i?i<3?(i>1&&(d.n=-1),p(i,u)):d.n=u:d.v=u);try{if(s=2,c){if(i||(o="next"),e=c[o]){if(!(e=e.call(c,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,i<2&&(i=0)}else 1===i&&(e=c.return)&&e.call(c),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==a)break}catch(e){c=t,i=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,c),!0),s}var a={};function i(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(b(e={},r,(function(){return this})),e),f=s.prototype=i.prototype=Object.create(l);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,b(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,b(f,"constructor",s),b(s,"constructor",u),u.displayName="GeneratorFunction",b(s,o,"GeneratorFunction"),b(f),b(f,o,"Generator"),b(f,r,(function(){return this})),b(f,"toString",(function(){return"[object Generator]"})),(_=function(){return{w:c,m:d}})()}function b(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}b=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function c(e,n){b(t,e,(function(t){return this._invoke(e,n,t)}))}c("next",0),c("throw",1),c("return",2)}},b(t,e,n,r)}function S(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function g(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var c=t.apply(e,n);function a(t){S(c,r,o,a,i,"next",t)}function i(t){S(c,r,o,a,i,"throw",t)}a(void 0)}))}}var k,j,w,E,q,L,C,O=document.querySelector(".places__list"),P=document.querySelector(".profile__edit-button"),T=document.querySelector(".profile__add-button"),x=document.querySelector(".popup_type_edit"),A=document.forms["edit-profile"],F=document.querySelector(".profile__title"),G=document.querySelector(".profile__description"),U=document.querySelector(".profile__image"),D=A.querySelector(".button"),N=document.querySelector(".popup_type_image"),M=N.querySelector(".popup__image"),B=N.querySelector(".popup__caption"),I=document.querySelector(".popup_type_new-card"),H=document.forms["new-place"],J=H.querySelector(".button"),V=document.querySelector(".popup_type_avatar"),z=document.querySelector(".profile__image-edit-button"),$=document.forms["edit-avatar"],K=$.querySelector(".button"),Q=($.querySelector(".popup__input_type_avatar_url"),{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button-disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),R={profileAvatar:U,profileTitle:F,profileDesc:G,container:O,createFunc:function(t,e,n,r,c,a,i,u){var s=l.cloneNode(!0),f=s.querySelector(".card__delete-button"),d=s.querySelector(".card__like-button"),p=s.querySelector(".card__image"),v=s.querySelector(".card__like-ammount");return s.querySelector(".card__title").textContent=t,p.src=e,p.alt="На картинке изображен "+t,v.textContent=c.length,i===u?f.addEventListener("click",(function(t){var e=t.target.closest(".card");n(a,e)})):f.remove(),c.find((function(t){return t._id===i}))&&d.classList.add("card__like-button_is-active"),d.addEventListener("click",(function(){return function(t,e,n){t.classList.contains("card__like-button_is-active")?(function(t){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}(n).then((function(t){return e.textContent=t.likes.length})),t.classList.toggle("card__like-button_is-active")):(function(t){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}(n).then((function(t){return e.textContent=t.likes.length})),t.classList.toggle("card__like-button_is-active"))}(d,v,a)})),p.addEventListener("click",(function(){return r(p.src,p.alt,t)})),s},deleteFunc:function(t,e){!function(t){fetch("".concat(o.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:o.headers}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}(t),e.remove()},openFunc:function(t,e,n){M.src=t,M.alt=e,B.textContent=n,f(N)}};function W(t){t.textContent="Сохранение..."}function X(t){t.textContent="Сохранить"}i(R),P.addEventListener("click",(function(){f(x),A.name.value=F.textContent,A.description.value=G.textContent,h(x,Q)})),z.addEventListener("click",g(_().m((function t(){return _().w((function(t){for(;;)switch(t.n){case 0:f(V),$.avatar.value="",h(V,Q);case 1:return t.a(2)}}),t)})))),T.addEventListener("click",(function(){f(I),H["place-name"].value="",H.link.value="",h(H,Q)})),$.addEventListener("submit",function(){var t=g(_().m((function t(e){var n;return _().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),n=$.avatar.value,W(K),t.n=1,s(n);case 1:return t.n=2,i(R);case 2:d(V),X(K);case 3:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}()),H.addEventListener("submit",function(){var t=g(_().m((function t(e){var n,r;return _().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),n=H["place-name"].value,r=H.link.value,t.n=1,c=n,a=r,fetch("".concat(o.baseUrl,"/cards"),{method:"POST",headers:o.headers,body:JSON.stringify({name:c,link:a})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}));case 1:return W(J),t.n=2,i(R);case 2:d(I),H["place-name"].value="",H.link.value="",X(J);case 3:return t.a(2)}var c,a}),t)})));return function(e){return t.apply(this,arguments)}}()),A.addEventListener("submit",function(){var t=g(_().m((function t(e){return _().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),t.n=1,n=A.elements.name.value,r=A.elements.description.value,void fetch("".concat(o.baseUrl,"/users/me"),{method:"PATCH",headers:o.headers,body:JSON.stringify({name:n,about:r})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}));case 1:return W(D),t.n=2,i(R);case 2:d(x),X(D);case 3:return t.a(2)}var n,r}),t)})));return function(e){return t.apply(this,arguments)}}()),j=(k=Q).formSelector,w=k.inputSelector,E=k.submitButtonSelector,q=k.inactiveButtonClass,L=k.inputErrorClass,C=k.errorClass,Array.from(document.querySelectorAll(j)).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),Array.from(t.querySelectorAll(w)).forEach((function(e){!function(t,e,n,r,o,c){var a=Array.from(t.querySelectorAll(e)),i=t.querySelector(n);m(a,i,r),a.forEach((function(e){e.addEventListener("input",(function(){!function(t,e,n,r){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?y(t,e,n,r):function(t,e,n,r,o){var c=t.querySelector(".".concat(e.id,"-error"));e.classList.add(r),c.textContent=n,c.classList.add(o)}(t,e,e.validationMessage,n,r)}(t,e,o,c),m(a,i,r)}))}))}(t,w,E,q,L,C)}))}))})();